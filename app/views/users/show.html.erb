<div class="mt-4 mb-4">
  <h2>User: <%= @user.email %>  </h2>
</div>

<div>

  <div>
    <ul id="myTab" class="nav nav-tabs">
      <li class="nav-item">
        <a id="user-info-link" data-toggle="tab" class="nav-link" href="#user">User Info</a>

      </li>
      <li class="nav-item">
        <a id="bookings-link" data-toggle="tab" class="nav-link" href="#bookings">My Bookings</a>
      </li>
      <li class="nav-item">
        <a id="trabis-link" data-toggle="tab" class="nav-link" href="#trabis">My Trabis</a>
      </li>
    </ul>
  </div>
  <div id="user-info-tab" class="bg-white p-4">
    <div style="width: 60%" >

      <%= simple_form_for(@user) do |f| %>
        <h5>Personal data</h5>
        <div class="border-top border-dark pt-4 pb-3">
          <div class="d-flex">
            <div class="form-group mr-3">
              <%= cl_image_tag @user.photo, height: 230, width: 230, crop: :fill, gravity: :face  %>
            </div>
            <div id="files-field"
               class="dropzone"
               style="border: 2px dashed rgba(0, 0, 0, 0.3);
                      height: 230px !important; width: 100%; background-color: #F4F4F4">
              <div class="dz-message"
                   style="margin: 65px 20px">
                Drag your avatar here or click to select file!
              </div>
            </div>
          </div>

          <div class="d-flex  mt-4">
            <div class="form-group w-30 mr-3">
              <%= f.input :first_name %>
            </div>
             <div class="form-group w-100">
              <%= f.input :last_name %>
            </div>
          </div>
          <div class="d-flex">
            <div class="form-group w-100 mr-3">
              <%= f.input :email %>
            </div>
             <div class="form-group w-40">
              <%= f.input :phone_number %>
            </div>
          </div>
        </div>

        <h5>Address</h5>
        <div class="border-top border-bottom border-dark pb-3 mb-4">

          <div class="d-flex  mt-4">
            <div class="form-group w-100 mr-3">
              <%= f.input :street_address %>
            </div>
             <div class="form-group w-90">
              <%= f.input :city_address %>
            </div>
          </div>
          <div class="d-flex">
            <div class="form-group w-40 mr-3">
              <%= f.input :zip_address %>
            </div>
             <div class="form-group w-100">
              <%= f.input :country_address %>
            </div>
          </div>

        </div>

        <%= f.submit %>



      <% end %>

    </div>

  </div>

  <div id="bookings-tab" class="bg-white p-4">
    <h5>Current bookings</h5>
    <% if @current_bookings == [] %>
      <div class="mt-3 mb-5">
        <em>No current bookings</em>
      </div>
    <% else %>

      <table class="table">
        <thead>
          <tr>
            <th scope="col" class="th-lg">Booking #</th>
            <th scope="col" class="th-lg">Start date</th>
            <th scope="col" class="th-lg">End date</th>
            <th scope="col" class="th-lg">Car</th>
            <th scope="col" class="th-lg">Owner</th>
            <th scope="col" class="th-lg"></th>
          </tr>
        </thead>
        <tbody>
          <% @current_bookings.each do |booking| %>
          <tr>
            <th scope="row" class="align-middle"><%= booking.id %></th>
            <td class="align-middle"><%= booking.start_date.strftime("%F %T") %></td>
            <% if booking.start_date == booking.end_date %>
              <td class="align-middle"><em>Still running</em></td>
            <% else %>
              <td class="align-middle"><%= booking.end_date.strftime("%F %T") %></td>
            <% end %>

            <td class="align-middle"><%= booking.trabi.title %></td>
            <td class="align-middle"><%= booking.trabi.user.email %></td>
            <% if booking.start_date == booking.end_date %>
              <td class="align-middle pt-1 pb-1"><a href="#" class="btn btn-primary disabled">Review</a></td>
            <% else %>
              <td class="align-middle pt-1 pb-1"><a href="#" class="btn btn-primary">Review</a></td>
            <% end %>
          </tr>
          <% end %>
        </tbody>
      </table>

    <% end %>

    <h5 class="pt-4">Archived bookings</h5>
    <% if @archived_bookings == [] %>
      <div class="mt-3 mb-5">
        <em>No archived bookings</em>
      </div>
    <% else %>

      <table class="table">
      <thead>
        <tr>
          <th scope="col" class="th-lg">Booking #</th>
          <th scope="col" class="th-lg">Start date</th>
          <th scope="col" class="th-lg">End date</th>
          <th scope="col" class="th-lg">Car</th>
          <th scope="col" class="th-lg">Owner</th>
          <th scope="col" class="th-lg">Rating</th>
        </tr>
      </thead>
      <tbody>
        <% @archived_bookings.each do |booking| %>
        <tr>
          <th scope="row"><%= booking.id %></th>
          <td><%= booking.start_date.strftime("%F %T") %></td>
          <td><%= booking.end_date.strftime("%F %T") %></td>
          <td><%= booking.trabi.title %></td>
          <td><%= booking.trabi.user.email %></td>
          <% if booking.rating_review.nil? %>
            <td><em>No rating</em></td>
          <% else %>
            <td>
              <% if booking.rating_review.zero? %>
                <i class="fas fa-skull-crossbones text-danger"></i>
              <% else %>
                <% booking.rating_review.times do %>
                  <i class="fas fa-star text-warning"></i>
                <% end %>
              <% end %>
            </td>
          <% end %>
        </tr>
        <% end %>
      </tbody>
    </table>

  <% end %>

  </div>
  <div id="trabis-tab" class="bg-white p-4">
    <h5>My current cars</h5>
    <% if @user.trabis == [] %>
      <div class="mt-3 mb-5">
        <em>No trabis offered yet</em>
      </div>
    <% else %>

      <table class="table">
        <thead>
          <tr>
            <th scope="col" class="th-lg">Trabi #</th>
            <th scope="col" class="th-lg">Title</th>
            <th scope="col" class="th-lg">Color</th>
            <th scope="col" class="th-lg">Year</th>
            <th scope="col" class="th-lg"></th>
          </tr>
        </thead>
        <tbody>
          <% @user.trabis.each do |trabi| %>
          <tr>
            <th scope="row"><%= trabi.id %></th>
            <td class="align-middle"><%= trabi.title %></td>
            <td class="align-middle"><%= trabi.color %></td>
            <td class="align-middle"><%= trabi.year %></td>
            <td class="pt-1 pb-1"><%= link_to "Details", trabi_path(trabi), class: "btn btn-primary" %>
            <!-- <a href="#" class="btn btn-primary">Details</a> --></td>
          </tr>
          <% end %>
        </tbody>
      </table>

    <% end %>
  </div>
</div>
