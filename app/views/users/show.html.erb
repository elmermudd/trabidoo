<h2>User: <%= @user.email %>  </h2>





<div>

  <div>
    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a id="user-info-link" class="nav-link" href="#">User info</a>

      </li>
      <li class="nav-item">
        <a id="bookings-link" class="nav-link" href="#">My Bookings</a>
      </li>
      <li class="nav-item">
        <a id="trabis-link"class="nav-link" href="#">My Trabis</a>
      </li>
    </ul>
  </div>
  <div id="user-info-tab" class="bg-white p-4"">
    <div style="width: 60%">
      <%= simple_form_for(@user, method: :patch, url: user_path(@user)) do |f| %>

      <div class="form-group">
        <%= f.label "User info:" %>
      </div>
      <div class="d-flex">
        <div class="form-group w-50 mr-3">
          <%= f.input :first_name, label: "First name:" %>
        </div>
         <div class="form-group w-100">
          <%= f.input :last_name, label: "Last name:"  %>
        </div>
      </div>
      <div class="d-flex">
        <div class="form-group w-100 mr-3">
          <%= f.input :email, label: "Email:" %>
        </div>
         <div class="form-group w-50">
          <%= f.input :phone_number, label: "Phone number:" %>
        </div>
      </div>
      <div class="form-group">
        <%= f.label "Address:" %>
      </div>
      <div class="d-flex">
         <div class="form-group w-100 mr-3">
          <%= f.input :street_address, label: "Street:" %>
        </div>
         <div class="form-group w-50">
          <%= f.input :city_address, label: "City:" %>
        </div>
      </div>
      <div class="d-flex">
        <div class="form-group w-40 mr-3">
          <%= f.input :zip_address, label: "ZIP:" %>
        </div>

        <div class="form-group">
          <%= f.label "Country:" %>
          <%= f.country_select :country_address, priority_countries: ["FR", "DE", "RU", "CZ"], selected: @user.country_address, class: "country-select-box" %>
        </div>
      </div>

      <%= f.button :submit, "Update", class: 'btn btn-primary' %>
    <% end %>

    </div>

  </div>

  <div id="bookings-tab" class="bg-white p-4">
    <h5>Current bookings</h5>
    <% if @current_bookings == [] %>
      <div class="mt-3 mb-5">
        <em>No current bookings</em>
      </div>
    <% else %>

      <table class="table">
        <thead>
          <tr>
            <th scope="col">Booking #</th>
            <th scope="col">Start date</th>
            <th scope="col">End date</th>
            <th scope="col">Car</th>
            <th scope="col">Owner</th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody>
          <% @current_bookings.each do |booking| %>
          <tr>
            <th scope="row"><%= booking.id %></th>
            <td><%= booking.start_date.strftime("%F %T") %></td>
            <% if booking.start_date == booking.end_date %>
              <td><em>Still running</em></td>
            <% else %>
              <td><%= booking.end_date.strftime("%F %T") %></td>
            <% end %>

            <td><%= booking.trabi.title %></td>
            <td><%= booking.trabi.user.email %></td>
            <% if booking.start_date == booking.end_date %>
              <td><a href="#" class="btn btn-primary disabled">Review</a></td>
            <% else %>
              <td><a href="#" class="btn btn-primary">Review</a></td>
            <% end %>
          </tr>
          <% end %>
        </tbody>
      </table>

    <% end %>

    <h5>Archived bookings</h5>
    <% if @archived_bookings == [] %>
      <div class="mt-3 mb-5">
        <em>No current bookings</em>
      </div>
    <% else %>

      <table class="table">
      <thead>
        <tr>
          <th scope="col">Booking #</th>
          <th scope="col">Start date</th>
          <th scope="col">End date</th>
          <th scope="col">Car</th>
          <th scope="col">Owner</th>
          <th scope="col">Rating</th>
        </tr>
      </thead>
      <tbody>
        <% @archived_bookings.each do |booking| %>
        <tr>
          <th scope="row"><%= booking.id %></th>
          <td><%= booking.start_date.strftime("%F %T") %></td>
          <td><%= booking.end_date.strftime("%F %T") %></td>
          <td><%= booking.trabi.title %></td>
          <td><%= booking.trabi.user.email %></td>
          <% if booking.rating_review.nil? %>
            <td><em>No rating</em></td>
          <% else %>
            <td>
              <% if booking.rating_review.zero? %>
                <i class="fas fa-skull-crossbones"></i>
              <% else %>
                <% booking.rating_review.times do %>
                  <i class="fas fa-star"></i>
                <% end %>
              <% end %>
            </td>
          <% end %>
        </tr>
        <% end %>
      </tbody>
    </table>

  <% end %>


  </div>
  <div id="trabis-tab" class="bg-white p-4">
    <table class="table">
      <thead>
        <tr>
          <th scope="col">Trabi #</th>
          <th scope="col">Title</th>
          <th scope="col">Color</th>
          <th scope="col">Year</th>
          <th scope="col"></th>
        </tr>
      </thead>
      <tbody>
        <% @user.trabis.each do |trabi| %>
          <th scope="row"><%= trabi.id %></th>
          <td><%= trabi.title %></td>
          <td><%= trabi.color %></td>
          <td><%= trabi.year %></td>
          <td><a href="#" class="btn btn-primary">Details</a></td>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
